language: rust
os: linux
cache: cargo

rust:
  - stable
  - beta
  - 1.39.0

jobs:
  allow_failures:
    - rust: nightly
      env: TOOL=NONE
  fast_finish: true
  include:
    - rust: nightly
      env: TOOL=NONE
    - rust: nightly
      env: TOOL=CLIPPY
      script: |
          rustup toolchain install nightly --allow-downgrade --component clippy
          cargo clippy -- -D clippy::all
    - rust: nightly
      env: TOOL=FMT
      script: |
          rustup toolchain install nightly --allow-downgrade --component rustfmt
          cargo fmt -- --check

script:
- cargo build
- cargo test
- cargo doc --no-deps